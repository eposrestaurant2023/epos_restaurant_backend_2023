var C=(N,$,f)=>new Promise((z,v)=>{var L=i=>{try{u(f.next(i))}catch(b){v(b)}},n=i=>{try{u(f.throw(i))}catch(b){v(b)}},u=i=>i.done?z(i.value):Promise.resolve(i.value).then(L,n);u((f=f.apply(N,$)).next())});import{_ as G,i as S,u as K,a as Q,r as X,b as Y,c as P,d as Z,w as l,e as g,o as j,f as t,g as s,h as r,t as m,n as ee,j as se,k as c,l as te,m as oe,p as I,A as ne}from"./index-f9822ba8.js";const ie={class:"h-full w-full p-10 flex justify-center items-center"},le={class:"app-info w-96 inline-block text-center rounded-lg pa-4 bg-gradient-to-t from-yellow-900 to-yellow-700 text-white shadow-sm"},ae={class:"mb-3"},re=["src"],de={class:"font-bold mb-3"},ce={class:"py-3"},ue={class:"h-full flex items-center justify-center bg-gray-100"},pe=["onSubmit"],me={class:"w-73"},_e={class:"d-block d-md-none mt-4"},ge={class:"mb-3"},fe=["src"],ve={class:"text-center mb-3"},be={class:"font-bold mb-1 text-2xl"},we={class:"text-sm"},he={class:"mb-3"},ke={class:"relative"},xe={class:"grid grid-cols-3 gap-3"},$e={class:"mt-6"},ye={class:"mt-2"},Ce={class:"mt-4 text-center"},Se={class:"text-sm text-green-700"},ze={key:0,class:"fixed bottom-8"},Le={__name:"Login",setup(N){S("$moment");const $=S("$gv"),f=S("$sale"),{mobile:z}=K(),v=ne(),L=Q();let n=X({username:"",password:""});const u=Y(),i=P(()=>JSON.parse(localStorage.getItem("setting"))),b=P(()=>u.state.isLoading);function D(o){localStorage.setItem("lang",o),location.reload()}const O=S("$auth");u.state.isLoading=!1;function p(o){n.password==null&&(n.password=""),n.password=n.password+o}function A(){n.password=""}function J(){return localStorage.getItem("is_window")=="1"}function M(){n.password=n.password.substring(0,n.password.length-1)}const R=()=>C(this,null,function*(){if(!n.password){v.warning("Invalid Password",{position:"top"});return}u.dispatch("startLoading"),I({url:"epos_restaurant_2023.api.api.check_username",auto:!0,params:{pin_code:n.password},onSuccess(e){return C(this,null,function*(){u.dispatch("startLoading"),n.username=e.username,n.username&&n.password&&((yield O.login(n.username,n.password))?(U(e),W()):(v.warning("Login fail. Invalid username or password."),u.dispatch("endLoading")))})},onError(e){u.dispatch("endLoading")}})});function U(o){I({url:"epos_restaurant_2023.api.api.get_user_information",auto:!0,onSuccess(_){return C(this,null,function*(){_.permission=o.permission,localStorage.setItem("current_user",JSON.stringify(_)),L.push({name:"Home"}),u.dispatch("endLoading")})},onError(_){u.dispatch("endLoading")}})}function W(){I({url:"epos_restaurant_2023.api.promotion.check_promotion",cache:"check_promotion",auto:!0,params:{business_branch:$.setting.business_branch},onSuccess(o){$.promotion=o,f.promotion=o}})}function H(){const o={action:"exit"};window.chrome.webview.postMessage(JSON.stringify(o))}return(o,e)=>{const _=g("v-divider"),y=g("v-list-item"),T=g("v-list"),V=g("v-col"),q=g("v-text-field"),d=g("v-btn"),F=g("v-row");return j(),Z(F,{class:"mt-0 mb-0 h-screen"},{default:l(()=>[t(V,{md:"6",lg:"8",class:"pa-0 d-sm-none d-none d-md-block"},{default:l(()=>{var w,h,k;return[s("div",{class:"h-screen bg-cover bg-no-repeat bg-center",style:ee({"background-image":"url("+((w=r(i))==null?void 0:w.login_background)+")"})},[s("div",ie,[s("div",null,[s("div",le,[s("div",ae,[s("img",{class:"my-0 mx-auto",src:(h=r(i))==null?void 0:h.logo},null,8,re)]),s("h1",de,m((k=r(i))==null?void 0:k.app_name),1),t(_),s("div",ce,[t(T,{lines:"one","bg-color":"transparent"},{default:l(()=>{var x,a,B,E;return[t(y,{class:"mb-2",title:(x=r(i))==null?void 0:x.business_branch,subtitle:o.$t("Business")},null,8,["title","subtitle"]),t(y,{class:"mb-2",title:(a=r(i))==null?void 0:a.pos_profile,subtitle:o.$t("POS Profile")},null,8,["title","subtitle"]),t(y,{class:"mb-2",title:(B=r(i))==null?void 0:B.phone_number,subtitle:o.$t("Phone Number")},null,8,["title","subtitle"]),t(y,{title:(E=r(i))==null?void 0:E.address,subtitle:o.$t("Address")},null,8,["title","subtitle"])]}),_:1})])])])])],4)]}),_:1}),t(V,{sm:"12",md:"6",lg:"4",class:"pa-0 relative"},{default:l(()=>{var w,h,k,x;return[s("div",ue,[s("form",{onSubmit:se(R,["prevent"])},[s("div",me,[s("div",null,[s("div",_e,[s("div",ge,[s("img",{class:"my-0 mx-auto w-16",src:(w=r(i))==null?void 0:w.logo},null,8,fe)]),s("div",ve,[s("h1",be,m((h=r(i))==null?void 0:h.app_name),1),s("p",we,m((k=r(i))==null?void 0:k.business_branch),1),t(_)])]),s("div",he,[s("div",ke,[t(q,{readonly:r(z),type:"password",density:"compact",variant:"solo",autofocus:"",label:o.$t("Password"),"append-inner-icon":"mdi-arrow-left","single-line":"","hide-details":"",modelValue:r(n).password,"onUpdate:modelValue":e[0]||(e[0]=a=>r(n).password=a),height:"200","onClick:appendInner":e[1]||(e[1]=a=>M())},null,8,["readonly","label","modelValue"])])]),s("div",null,[s("div",xe,[t(d,{onClick:e[2]||(e[2]=a=>p("1")),size:"x-large"},{default:l(()=>[c(" 1 ")]),_:1}),t(d,{onClick:e[3]||(e[3]=a=>p("2")),size:"x-large"},{default:l(()=>[c(" 2 ")]),_:1}),t(d,{onClick:e[4]||(e[4]=a=>p("3")),size:"x-large"},{default:l(()=>[c(" 3 ")]),_:1}),t(d,{onClick:e[5]||(e[5]=a=>p("4")),size:"x-large"},{default:l(()=>[c(" 4 ")]),_:1}),t(d,{onClick:e[6]||(e[6]=a=>p("5")),size:"x-large"},{default:l(()=>[c(" 5 ")]),_:1}),t(d,{onClick:e[7]||(e[7]=a=>p("6")),size:"x-large"},{default:l(()=>[c(" 6 ")]),_:1}),t(d,{onClick:e[8]||(e[8]=a=>p("7")),size:"x-large"},{default:l(()=>[c(" 7 ")]),_:1}),t(d,{onClick:e[9]||(e[9]=a=>p("8")),size:"x-large"},{default:l(()=>[c(" 8 ")]),_:1}),t(d,{onClick:e[10]||(e[10]=a=>p("9")),size:"x-large"},{default:l(()=>[c(" 9 ")]),_:1}),t(d,{onClick:e[11]||(e[11]=a=>p("0")),size:"x-large"},{default:l(()=>[c(" 0 ")]),_:1}),t(d,{class:"col-span-2",color:"error",onClick:A,size:"x-large"},{default:l(()=>[c(m(o.$t("Clear")),1)]),_:1})])]),s("div",$e,[t(d,{type:"submit",loading:r(b),size:"x-large",class:"w-full",color:"primary"},{default:l(()=>[c(m(o.$t("Login")),1)]),_:1},8,["loading"])]),s("div",ye,[t(d,{size:"x-large",class:"w-full",color:"light",onClick:e[12]||(e[12]=()=>{o.$i18n.locale=o.$i18n.locale=="kh"?"en":"kh",D(o.$i18n.locale)})},{default:l(()=>[c(m(o.$i18n.locale=="en"?"ខ្មែរ":"English"),1)]),_:1})]),s("div",Ce,[s("p",Se,m((x=r(i))==null?void 0:x.pos_profile),1)])])])],40,pe),J()?(j(),te("div",ze,[t(d,{block:"",class:"w-full","prepend-icon":"mdi-window-close",size:"x-large",color:"error",onClick:e[13]||(e[13]=a=>H())},{default:l(()=>[c(m(o.$t("Exit")),1)]),_:1})])):oe("",!0)])]}),_:1})]),_:1})}}},Ve=G(Le,[["__scopeId","data-v-a891e0cf"]]);export{Ve as default};
