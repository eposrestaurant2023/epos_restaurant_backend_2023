var C=(N,k,g)=>new Promise((z,f)=>{var L=n=>{try{c(g.next(n))}catch(v){f(v)}},o=n=>{try{c(g.throw(n))}catch(v){f(v)}},c=n=>n.done?z(n.value):Promise.resolve(n.value).then(L,o);c((g=g.apply(N,k)).next())});import{_ as F,i as $,u as G,a as K,r as Q,b as X,c as j,d as Y,w as i,e as m,o as D,f as t,g as s,h as l,t as S,n as Z,j as ee,k as d,l as se,m as te,p as I,A as oe}from"./index-bb732662.js";const ne={class:"h-full w-full p-10 flex justify-center items-center"},ie={class:"app-info w-96 inline-block text-center rounded-lg pa-4 bg-gradient-to-t from-yellow-900 to-yellow-700 text-white shadow-sm"},ae={class:"mb-3"},le=["src"],re={class:"font-bold mb-3"},de={class:"py-3"},ce={class:"h-full flex items-center justify-center bg-gray-100"},ue=["onSubmit"],_e={class:"w-73"},pe={class:"d-block d-md-none mt-4"},me={class:"mb-3"},ge=["src"],fe={class:"text-center mb-3"},ve={class:"font-bold mb-1 text-2xl"},be={class:"text-sm"},we={class:"mb-3"},xe={class:"relative"},he={class:"grid grid-cols-3 gap-3"},ke={class:"mt-6"},ye={class:"mt-4 text-center"},Ce={class:"text-sm text-green-700"},$e={key:0,class:"fixed bottom-8"},Se={__name:"Login",setup(N){$("$moment");const k=$("$gv"),g=$("$sale"),{mobile:z}=G(),f=oe(),L=K();let o=Q({username:"",password:""});const c=X(),n=j(()=>JSON.parse(localStorage.getItem("setting"))),v=j(()=>c.state.isLoading),E=$("$auth");c.state.isLoading=!1;function u(_){o.password==null&&(o.password=""),o.password=o.password+_}function O(){o.password=""}function A(){return localStorage.getItem("is_window")=="1"}function J(){o.password=o.password.substring(0,o.password.length-1)}const M=()=>C(this,null,function*(){if(!o.password){f.warning("Invalid Password",{position:"top"});return}c.dispatch("startLoading"),I({url:"epos_restaurant_2023.api.api.check_username",auto:!0,params:{pin_code:o.password},onSuccess(e){return C(this,null,function*(){c.dispatch("startLoading"),o.username=e.username,o.username&&o.password&&((yield E.login(o.username,o.password))?(R(e),U()):(f.warning("Login fail. Invalid username or password."),c.dispatch("endLoading")))})},onError(e){c.dispatch("endLoading")}})});function R(_){I({url:"epos_restaurant_2023.api.api.get_user_information",auto:!0,onSuccess(p){return C(this,null,function*(){p.permission=_.permission,localStorage.setItem("current_user",JSON.stringify(p)),L.push({name:"Home"}),c.dispatch("endLoading")})},onError(p){c.dispatch("endLoading")}})}function U(){I({url:"epos_restaurant_2023.api.promotion.check_promotion",cache:"check_promotion",auto:!0,params:{business_branch:k.setting.business_branch},onSuccess(_){k.promotion=_,g.promotion=_}})}function W(){const _={action:"exit"};window.chrome.webview.postMessage(JSON.stringify(_))}return(_,e)=>{const p=m("v-divider"),y=m("v-list-item"),H=m("v-list"),V=m("v-col"),T=m("v-text-field"),r=m("v-btn"),q=m("v-row");return D(),Y(q,{class:"mt-0 mb-0 h-screen"},{default:i(()=>[t(V,{md:"6",lg:"8",class:"pa-0 d-sm-none d-none d-md-block"},{default:i(()=>{var b,w,x;return[s("div",{class:"h-screen bg-cover bg-no-repeat bg-center",style:Z({"background-image":"url("+((b=l(n))==null?void 0:b.login_background)+")"})},[s("div",ne,[s("div",null,[s("div",ie,[s("div",ae,[s("img",{class:"my-0 mx-auto",src:(w=l(n))==null?void 0:w.logo},null,8,le)]),s("h1",re,S((x=l(n))==null?void 0:x.app_name),1),t(p),s("div",de,[t(H,{lines:"one","bg-color":"transparent"},{default:i(()=>{var h,a,B,P;return[t(y,{class:"mb-2",title:(h=l(n))==null?void 0:h.business_branch,subtitle:"Business"},null,8,["title"]),t(y,{class:"mb-2",title:(a=l(n))==null?void 0:a.pos_profile,subtitle:"POS Profile"},null,8,["title"]),t(y,{class:"mb-2",title:(B=l(n))==null?void 0:B.phone_number,subtitle:"Phone Number"},null,8,["title"]),t(y,{title:(P=l(n))==null?void 0:P.address,subtitle:"Address"},null,8,["title"])]}),_:1})])])])])],4)]}),_:1}),t(V,{sm:"12",md:"6",lg:"4",class:"pa-0 relative"},{default:i(()=>{var b,w,x,h;return[s("div",ce,[s("form",{onSubmit:ee(M,["prevent"])},[s("div",_e,[s("div",null,[s("div",pe,[s("div",me,[s("img",{class:"my-0 mx-auto w-16",src:(b=l(n))==null?void 0:b.logo},null,8,ge)]),s("div",fe,[s("h1",ve,S((w=l(n))==null?void 0:w.app_name),1),s("p",be,S((x=l(n))==null?void 0:x.business_branch),1),t(p)])]),s("div",we,[s("div",xe,[t(T,{readonly:l(z),type:"password",density:"compact",variant:"solo",autofocus:"",label:"Password","append-inner-icon":"mdi-arrow-left","single-line":"","hide-details":"",modelValue:l(o).password,"onUpdate:modelValue":e[0]||(e[0]=a=>l(o).password=a),height:"200","onClick:appendInner":e[1]||(e[1]=a=>J())},null,8,["readonly","modelValue"])])]),s("div",null,[s("div",he,[t(r,{onClick:e[2]||(e[2]=a=>u("1")),size:"x-large"},{default:i(()=>[d(" 1 ")]),_:1}),t(r,{onClick:e[3]||(e[3]=a=>u("2")),size:"x-large"},{default:i(()=>[d(" 2 ")]),_:1}),t(r,{onClick:e[4]||(e[4]=a=>u("3")),size:"x-large"},{default:i(()=>[d(" 3 ")]),_:1}),t(r,{onClick:e[5]||(e[5]=a=>u("4")),size:"x-large"},{default:i(()=>[d(" 4 ")]),_:1}),t(r,{onClick:e[6]||(e[6]=a=>u("5")),size:"x-large"},{default:i(()=>[d(" 5 ")]),_:1}),t(r,{onClick:e[7]||(e[7]=a=>u("6")),size:"x-large"},{default:i(()=>[d(" 6 ")]),_:1}),t(r,{onClick:e[8]||(e[8]=a=>u("7")),size:"x-large"},{default:i(()=>[d(" 7 ")]),_:1}),t(r,{onClick:e[9]||(e[9]=a=>u("8")),size:"x-large"},{default:i(()=>[d(" 8 ")]),_:1}),t(r,{onClick:e[10]||(e[10]=a=>u("9")),size:"x-large"},{default:i(()=>[d(" 9 ")]),_:1}),t(r,{onClick:e[11]||(e[11]=a=>u("0")),size:"x-large"},{default:i(()=>[d(" 0 ")]),_:1}),t(r,{class:"col-span-2",color:"error",onClick:O,size:"x-large"},{default:i(()=>[d(" Clear ")]),_:1})])]),s("div",ke,[t(r,{type:"submit",loading:l(v),size:"x-large",class:"w-full",color:"primary"},{default:i(()=>[d("Login")]),_:1},8,["loading"])]),s("div",ye,[s("p",Ce,S((h=l(n))==null?void 0:h.pos_profile),1)])])])],40,ue),A()?(D(),se("div",$e,[t(r,{block:"",class:"w-full","prepend-icon":"mdi-window-close",size:"x-large",color:"error",onClick:e[12]||(e[12]=a=>W())},{default:i(()=>[d("exit")]),_:1})])):te("",!0)])]}),_:1})]),_:1})}}},Ie=F(Se,[["__scopeId","data-v-43322b88"]]);export{Ie as default};
