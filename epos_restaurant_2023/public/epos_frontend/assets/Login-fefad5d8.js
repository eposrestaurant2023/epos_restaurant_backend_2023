var $=(N,u,g)=>new Promise((z,C)=>{var b=a=>{try{n(g.next(a))}catch(r){C(r)}},L=a=>{try{n(g.throw(a))}catch(r){C(r)}},n=a=>a.done?z(a.value):Promise.resolve(a.value).then(b,L);n((g=g.apply(N,u)).next())});import{_ as G,i as K,a as S,u as Q,b as X,r as Y,c as Z,d as E,e as ee,w as i,f,o as j,g as t,h as s,j as o,t as v,n as se,k as te,l as c,m as oe,p as ne,q as I,A as ie}from"./index-fc34c105.js";const ae={class:"h-full w-full p-10 flex justify-center items-center"},le={class:"app-info w-96 inline-block text-center rounded-lg pa-4 bg-gradient-to-t from-yellow-900 to-yellow-700 text-white shadow-sm"},re={class:"mb-3"},de=["src"],ce={class:"font-bold mb-3"},ue={class:"py-3"},pe={class:"h-full flex items-center justify-center bg-gray-100"},_e=["onSubmit"],me={class:"w-73"},ge={class:"d-block d-md-none mt-4"},fe={class:"mb-3"},ve=["src"],be={class:"text-center mb-3"},we={class:"font-bold mb-1 text-2xl"},xe={class:"text-sm"},he={class:"mb-3"},ke={class:"relative"},ye={class:"grid grid-cols-3 gap-3"},Ce={class:"mt-6"},$e={class:"mt-4 text-center"},Se={class:"text-sm text-green-700"},ze={key:0,class:"fixed bottom-8"},Le={__name:"Login",setup(N){const{t:u}=K.global;S("$moment");const g=S("$gv"),z=S("$sale"),{mobile:C}=Q(),b=ie(),L=X();let n=Y({username:"",password:""});const a=Z(),r=E(()=>JSON.parse(localStorage.getItem("setting"))),D=E(()=>a.state.isLoading),O=S("$auth");a.state.isLoading=!1;function _(p){n.password==null&&(n.password=""),n.password=n.password+p}function A(){n.password=""}function J(){return localStorage.getItem("is_window")=="1"}function M(){n.password=n.password.substring(0,n.password.length-1)}const R=()=>$(this,null,function*(){if(!n.password){b.warning(u("msg.Invalid PIN Code"),{position:"top"});return}a.dispatch("startLoading");let p=!1;I({url:"epos_restaurant_2023.api.api.check_username",auto:!0,params:{pin_code:n.password},onSuccess(m){return $(this,null,function*(){a.dispatch("startLoading"),n.username=m.username,n.username&&n.password&&((yield O.login(n.username,n.password))?(U(m),W()):(b.warning("msg.Login fail Invalid username or password"),a.dispatch("endLoading")))})},onError(m){p||(p=!0,a.dispatch("endLoading"),b.warning(u("msg.Invalid PIN Code"),{position:"top"}))}})});function U(p){I({url:"epos_restaurant_2023.api.api.get_user_information",auto:!0,onSuccess(m){return $(this,null,function*(){m.permission=p.permission,localStorage.setItem("current_user",JSON.stringify(m)),L.push({name:"Home"}),a.dispatch("endLoading")})},onError(m){a.dispatch("endLoading")}})}function W(){I({url:"epos_restaurant_2023.api.promotion.check_promotion",cache:"check_promotion",auto:!0,params:{business_branch:g.setting.business_branch},onSuccess(p){g.promotion=p,z.promotion=p}})}function q(){const p={action:"exit"};window.chrome.webview.postMessage(JSON.stringify(p))}return(p,e)=>{const m=f("v-divider"),w=f("v-list-item"),H=f("v-list"),P=f("v-col"),T=f("v-text-field"),d=f("v-btn"),F=f("v-row");return j(),ee(F,{class:"mt-0 mb-0 h-screen"},{default:i(()=>[t(P,{md:"6",lg:"8",class:"pa-0 d-sm-none d-none d-md-block"},{default:i(()=>{var x,h,k;return[s("div",{class:"h-screen bg-cover bg-no-repeat bg-center",style:se({"background-image":"url("+((x=o(r))==null?void 0:x.login_background)+")"})},[s("div",ae,[s("div",null,[s("div",le,[s("div",re,[s("img",{class:"my-0 mx-auto",src:(h=o(r))==null?void 0:h.logo},null,8,de)]),s("h1",ce,v((k=o(r))==null?void 0:k.app_name),1),t(m),s("div",ue,[t(H,{lines:"one","bg-color":"transparent"},{default:i(()=>{var y,l,V,B;return[t(w,{class:"mb-2",title:(y=o(r))==null?void 0:y.business_branch,subtitle:o(u)("Business")},null,8,["title","subtitle"]),t(w,{class:"mb-2",title:(l=o(r))==null?void 0:l.pos_profile,subtitle:o(u)("POS Profile")},null,8,["title","subtitle"]),t(w,{class:"mb-2",title:(V=o(r))==null?void 0:V.phone_number,subtitle:o(u)("Phone Number")},null,8,["title","subtitle"]),t(w,{title:(B=o(r))==null?void 0:B.address,subtitle:o(u)("Address")},null,8,["title","subtitle"])]}),_:1})])])])])],4)]}),_:1}),t(P,{sm:"12",md:"6",lg:"4",class:"pa-0 relative"},{default:i(()=>{var x,h,k,y;return[s("div",pe,[s("form",{onSubmit:te(R,["prevent"])},[s("div",me,[s("div",null,[s("div",ge,[s("div",fe,[s("img",{class:"my-0 mx-auto w-16",src:(x=o(r))==null?void 0:x.logo},null,8,ve)]),s("div",be,[s("h1",we,v((h=o(r))==null?void 0:h.app_name),1),s("p",xe,v((k=o(r))==null?void 0:k.business_branch),1),t(m)])]),s("div",he,[s("div",ke,[t(T,{readonly:o(C),type:"password",density:"compact",variant:"solo",autofocus:"",label:o(u)("Password"),"append-inner-icon":"mdi-arrow-left","single-line":"","hide-details":"",modelValue:o(n).password,"onUpdate:modelValue":e[0]||(e[0]=l=>o(n).password=l),height:"200","onClick:appendInner":e[1]||(e[1]=l=>M())},null,8,["readonly","label","modelValue"])])]),s("div",null,[s("div",ye,[t(d,{onClick:e[2]||(e[2]=l=>_("1")),size:"x-large"},{default:i(()=>[c(" 1 ")]),_:1}),t(d,{onClick:e[3]||(e[3]=l=>_("2")),size:"x-large"},{default:i(()=>[c(" 2 ")]),_:1}),t(d,{onClick:e[4]||(e[4]=l=>_("3")),size:"x-large"},{default:i(()=>[c(" 3 ")]),_:1}),t(d,{onClick:e[5]||(e[5]=l=>_("4")),size:"x-large"},{default:i(()=>[c(" 4 ")]),_:1}),t(d,{onClick:e[6]||(e[6]=l=>_("5")),size:"x-large"},{default:i(()=>[c(" 5 ")]),_:1}),t(d,{onClick:e[7]||(e[7]=l=>_("6")),size:"x-large"},{default:i(()=>[c(" 6 ")]),_:1}),t(d,{onClick:e[8]||(e[8]=l=>_("7")),size:"x-large"},{default:i(()=>[c(" 7 ")]),_:1}),t(d,{onClick:e[9]||(e[9]=l=>_("8")),size:"x-large"},{default:i(()=>[c(" 8 ")]),_:1}),t(d,{onClick:e[10]||(e[10]=l=>_("9")),size:"x-large"},{default:i(()=>[c(" 9 ")]),_:1}),t(d,{onClick:e[11]||(e[11]=l=>_("0")),size:"x-large"},{default:i(()=>[c(" 0 ")]),_:1}),t(d,{class:"col-span-2",color:"error",onClick:A,size:"x-large"},{default:i(()=>[c(v(o(u)("Clear")),1)]),_:1})])]),s("div",Ce,[t(d,{type:"submit",loading:o(D),size:"x-large",class:"w-full",color:"primary"},{default:i(()=>[c(v(o(u)("Login")),1)]),_:1},8,["loading"])]),s("div",$e,[s("p",Se,v((y=o(r))==null?void 0:y.pos_profile),1)])])])],40,_e),J()?(j(),oe("div",ze,[t(d,{block:"",class:"w-full","prepend-icon":"mdi-window-close",size:"x-large",color:"error",onClick:e[12]||(e[12]=l=>q())},{default:i(()=>[c(v(o(u)("Exit")),1)]),_:1})])):ne("",!0)])]}),_:1})]),_:1})}}},Pe=G(Le,[["__scopeId","data-v-3ab83a0a"]]);export{Pe as default};
