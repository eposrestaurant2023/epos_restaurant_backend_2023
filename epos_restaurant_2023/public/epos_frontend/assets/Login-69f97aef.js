import{_ as R,i as U,a as w,u as W,b as q,c as H,r as T,d as y,o as F,e as G,w as i,f as g,g as C,h as t,j as s,k as o,t as _,n as K,l as Q,m as r,p as X,q as Y,s as h,A as Z}from"./index-d4506b92.js";const ee={class:"h-full w-full p-10 flex justify-center items-center"},se={class:"app-info w-96 inline-block text-center rounded-lg pa-4 bg-gradient-to-t from-yellow-900 to-yellow-700 text-white shadow-sm"},te={class:"mb-3"},oe=["src"],ne={class:"font-bold mb-3"},ie={class:"py-3"},le={class:"h-full flex items-center justify-center bg-gray-100"},ae=["onSubmit"],re={class:"w-73"},de={class:"d-block d-md-none mt-4"},ce={class:"mb-3"},ue=["src"],me={class:"text-center mb-3"},pe={class:"font-bold mb-1 text-2xl"},_e={class:"text-sm"},ge={class:"mb-3"},fe={class:"relative"},ve={class:"grid grid-cols-3 gap-3"},be={class:"mt-6"},we={class:"mt-2"},he={class:"mt-4 text-center"},xe={class:"text-sm text-green-700"},ke={key:0,class:"fixed bottom-8"},ye={__name:"Login",setup(Ce){const{t:u}=U.global,$=w("$auth"),x=w("$gv"),S=w("$sale"),{mobile:L}=W(),v=Z(),z=q(),p=H();p.state.isLoading=!1;let l=T({username:"",password:""});const c=y(()=>JSON.parse(localStorage.getItem("setting"))),I=y(()=>p.state.isLoading);F(()=>{localStorage.removeItem("current_user"),localStorage.removeItem("make_order_auth")});function N(n){localStorage.setItem("lang",n),location.reload()}function m(n){l.password==null&&(l.password=""),l.password=l.password+n}function P(){l.password=""}function V(){return localStorage.getItem("is_window")=="1"}function B(){l.password=l.password.substring(0,l.password.length-1)}const E=async()=>{if(!l.password){v.warning(u("msg.Invalid PIN Codex"),{position:"top"});return}p.dispatch("startLoading");let n=!1;h({url:"epos_restaurant_2023.api.api.check_username",auto:!0,params:{pin_code:l.password},async onSuccess(e){p.dispatch("startLoading"),l.username=e.username,l.username&&l.password&&(await $.login(l.username,l.password)?(j(e),D()):(v.warning("msg.Login fail Invalid username or password"),p.dispatch("endLoading")))},onError(e){n||(n=!0,p.dispatch("endLoading"),v.warning(u("msg.Invalid PIN Code"),{position:"top"}))}})};function j(n){h({url:"epos_restaurant_2023.api.api.get_user_information",auto:!0,async onSuccess(e){e.permission=n.permission,localStorage.setItem("current_user",JSON.stringify(e)),z.push({name:"Home"}),p.dispatch("endLoading")},onError(e){p.dispatch("endLoading")}})}function D(){h({url:"epos_restaurant_2023.api.promotion.check_promotion",cache:"check_promotion",auto:!0,params:{business_branch:x.setting.business_branch},onSuccess(n){x.promotion=n,S.promotion=n}})}function O(){const n={action:"exit"};window.chrome.webview.postMessage(JSON.stringify(n))}return(n,e)=>{const b=g("v-divider"),f=g("v-list-item"),A=g("v-list"),k=g("v-col"),J=g("v-text-field"),a=g("v-btn"),M=g("v-row");return C(),G(M,{class:"mt-0 mb-0 h-screen"},{default:i(()=>[t(k,{md:"6",lg:"8",class:"pa-0 d-sm-none d-none d-md-block"},{default:i(()=>[s("div",{class:"h-screen bg-cover bg-no-repeat bg-center",style:K({"background-image":"url("+o(c)?.login_background+")"})},[s("div",ee,[s("div",null,[s("div",se,[s("div",te,[s("img",{class:"my-0 mx-auto",src:o(c)?.logo},null,8,oe)]),s("h1",ne,_(o(c)?.app_name),1),t(b),s("div",ie,[t(A,{lines:"one","bg-color":"transparent"},{default:i(()=>[t(f,{class:"mb-2",title:o(c)?.business_branch,subtitle:o(u)("Business")},null,8,["title","subtitle"]),t(f,{class:"mb-2",title:o(c)?.pos_profile,subtitle:o(u)("POS Profile")},null,8,["title","subtitle"]),t(f,{class:"mb-2",title:o(c)?.phone_number,subtitle:o(u)("Phone Number")},null,8,["title","subtitle"]),t(f,{title:o(c)?.address,subtitle:o(u)("Address")},null,8,["title","subtitle"])]),_:1})])])])])],4)]),_:1}),t(k,{sm:"12",md:"6",lg:"4",class:"pa-0 relative"},{default:i(()=>[s("div",le,[s("form",{onSubmit:Q(E,["prevent"])},[s("div",re,[s("div",null,[s("div",de,[s("div",ce,[s("img",{class:"my-0 mx-auto w-16",src:o(c)?.logo},null,8,ue)]),s("div",me,[s("h1",pe,_(o(c)?.app_name),1),s("p",_e,_(o(c)?.business_branch),1),t(b)])]),s("div",ge,[s("div",fe,[t(J,{readonly:o(L),type:"password",density:"compact",variant:"solo",autofocus:"",label:o(u)("Password"),"append-inner-icon":"mdi-arrow-left","single-line":"","hide-details":"",modelValue:o(l).password,"onUpdate:modelValue":e[0]||(e[0]=d=>o(l).password=d),height:"200","onClick:appendInner":e[1]||(e[1]=d=>B())},null,8,["readonly","label","modelValue"])])]),s("div",null,[s("div",ve,[t(a,{onClick:e[2]||(e[2]=d=>m("1")),size:"x-large"},{default:i(()=>[r(" 1 ")]),_:1}),t(a,{onClick:e[3]||(e[3]=d=>m("2")),size:"x-large"},{default:i(()=>[r(" 2 ")]),_:1}),t(a,{onClick:e[4]||(e[4]=d=>m("3")),size:"x-large"},{default:i(()=>[r(" 3 ")]),_:1}),t(a,{onClick:e[5]||(e[5]=d=>m("4")),size:"x-large"},{default:i(()=>[r(" 4 ")]),_:1}),t(a,{onClick:e[6]||(e[6]=d=>m("5")),size:"x-large"},{default:i(()=>[r(" 5 ")]),_:1}),t(a,{onClick:e[7]||(e[7]=d=>m("6")),size:"x-large"},{default:i(()=>[r(" 6 ")]),_:1}),t(a,{onClick:e[8]||(e[8]=d=>m("7")),size:"x-large"},{default:i(()=>[r(" 7 ")]),_:1}),t(a,{onClick:e[9]||(e[9]=d=>m("8")),size:"x-large"},{default:i(()=>[r(" 8 ")]),_:1}),t(a,{onClick:e[10]||(e[10]=d=>m("9")),size:"x-large"},{default:i(()=>[r(" 9 ")]),_:1}),t(a,{onClick:e[11]||(e[11]=d=>m("0")),size:"x-large"},{default:i(()=>[r(" 0 ")]),_:1}),t(a,{class:"col-span-2",color:"error",onClick:P,size:"x-large"},{default:i(()=>[r(_(o(u)("Clear")),1)]),_:1})])]),s("div",be,[t(a,{type:"submit",loading:o(I),size:"x-large",class:"w-full",color:"primary"},{default:i(()=>[r(_(o(u)("Login")),1)]),_:1},8,["loading"])]),s("div",we,[t(a,{size:"x-large",class:"w-full",color:"light",onClick:e[12]||(e[12]=()=>{n.$i18n.locale=n.$i18n.locale=="kh"?"en":"kh",N(n.$i18n.locale)})},{default:i(()=>[r(_(n.$i18n.locale=="en"?"ខ្មែរ":"English"),1)]),_:1})]),s("div",he,[s("p",xe,_(o(c)?.pos_profile),1)])])])],40,ae),V()?(C(),X("div",ke,[t(a,{block:"",class:"w-full","prepend-icon":"mdi-window-close",size:"x-large",color:"error",onClick:e[13]||(e[13]=d=>O())},{default:i(()=>[r(_(o(u)("Exit")),1)]),_:1})])):Y("",!0)])]),_:1})]),_:1})}}},Se=R(ye,[["__scopeId","data-v-430740d5"]]);export{Se as default};
