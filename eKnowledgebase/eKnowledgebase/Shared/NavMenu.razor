@inject NavigationManager nav;
@inject eKnowledgebase.Services.eKnowledgebaseService s;
@if (!is_loading)
{
 <MudCard Elevation="0" Square="true">
        <MudCardHeader>
            <CardHeaderAvatar>
                <MudAvatar Image="images/cashier.png" />
            </CardHeaderAvatar>
            <CardHeaderContent>
                <MudText Typo="Typo.body2">eKnowledgebase</MudText>
            </CardHeaderContent>
        </MudCardHeader>
</MudCard>
<MudDivider Class="mb-4" />
<MudNavMenu>
     <MudNavLink Href="/eknowledgebase" Match="NavLinkMatch.All" Icon="@Icons.Material.Filled.Home">@(state.current_language == "en" ? "Home": "ទំព័រដើម")</MudNavLink>   

        @foreach(var m1 in models.Where(r=>r.is_public == true).OrderBy(r=>r.sort_order))
         { 
           <MudNavLink OnClick="@(()=> nav.NavigateTo($"app/{m1.id}",true))" Match="NavLinkMatch.All" Icon="@m1.icon">@state.GetTitleText(m1)</MudNavLink>   
        }
        
</MudNavMenu>
}

@code {
    [CascadingParameter]
    public AppState state { get; set; }
    List<eKnowledgebaseModel> models = new();
    bool is_loading;
    protected override async Task OnInitializedAsync()
    {
        is_loading = true;
        models = await s.GetModulesAsync();
        is_loading = false;
    }
}
