@inject IHttpService http
@inject IStringLocalizer<Resource> lang

<UIContainerBox Title="@lang["Modifier Information"]">
    <Com is_visible="@(!is_loading)"> 
        <ComProductDetail_TableViewModifier models="@models" product_category_id="@product.product_category_id" />
    </Com>
</UIContainerBox>
@code {
    [CascadingParameter] public GlobalVariableModel gv { get; set; }
    [Parameter] public ProductModel product {get; set;}
    List<ProductModifierModel> models = new List<ProductModifierModel>();
    bool is_loading;
    int TotalRecord = 0;

    protected override async Task OnInitializedAsync()
    {
        is_loading = true;
        if(product.id > 0){
            var resp = await http.ApiGetOData($"ProductModifier?$expand=children($expand=modifier($select=id,modifier_group_id,modifier_name);$filter=is_deleted eq false)&$filter=product_id eq {product.id} and is_deleted eq false and status eq true");
            if (resp.IsSuccess)
            {
                models = JsonSerializer.Deserialize<List<ProductModifierModel>>(resp.Content.ToString());
                TotalRecord = resp.Count;
            }
        }
        is_loading = false;
    }
}
